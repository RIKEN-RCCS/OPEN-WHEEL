# クラウドインスタンス 利用機能
## はじめに
本ドキュメントでは、2019年2月にWHEELへ実装されるクラウドインスタンス利用機能の仕様と、利用方法について解説します。

## クラウドインスタンス利用機能の概要
本機能を使用すると、WHEELがプロジェクト実行時にクラウド(現時点ではAWSのみ)上に、Linuxのクラスタ環境を作成し、リモートホストとしてその環境を利用してtaskおよびジョブを実行します。
作成されたインスタンスはプロジェクトの実行終了時にWHEELが自動的に削除します。

## クラウドインスタンス利用機能の使用方法
クラウドインスタンス利用機能を使用するには、remotehost画面で新規にホスト設定を作成する際に、使用するクラウドプロバイダを指定します。
AWSを使用する場合は、以下のパラメータを本画面で設定することができます。

- OS
- ノード数
- インスタンスタイプ
- インスタンスを起動するリージョン
- バッチサーバ(OpenPBS)を使用するかどうかのフラグ
- MPIライブラリ(OpenMPI)を使用するかどうかのフラグ
- コンパイラ(gcc)を使用するかどうかのフラグ
- ヘッドノードのストレージをNFSを用いてシェアするかどうかのフラグ

また、上記項目以外にEC2の起動オプションを追加で指定する場合は、クラスタ全体に共通の設定およびヘッドノードのみに固有の設定をそれぞれ追加することができます。指定可能な項目はAWSのドキュメントをご参照ください。

インスタンス起動後にカスタマイズを行なう場合は、remotehost画面からansibleのplaybookをアップロードしておけば全ノードの起動後にヘッドノードから実行されます。

AWSの起動時に使用するaccess keyおよびsecret access keyはaws-sdkの取り扱いと同様です。したがって、Shared Credential fileに保存するか、WHEELの起動時に必要な環境変数を設定することで指定してください。
Shared Credentials Fileの記述方法などは、以下のURLに記載があります。

https://docs.aws.amazon.com/ja_jp/sdk-for-javascript/v2/developer-guide/loading-node-credentials-shared.html


